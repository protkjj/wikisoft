# 📝 WIKISOFT3 기술 스펙 (초안)

**작성일**: 2025-12-30  
**목표 버전**: v3 (내부/제한 사용자용, AI 에이전트 친화)

---

## 1. 개요
- WIKISOFT2 자산을 재사용하여 제한된 사용자 풀(사내/파트너)에게 안정적인 검증·교정 경험 제공
- 초대규모/다중 테넌트보다는 "회사 앱" 수준의 신뢰도와 UX를 우선

## 2. 범위
- HR/재무 엑셀 파싱, 헤더 매칭, 규칙 검증, 자동 수정/리포트
- 에이전트 자동화(ReACT 루프): 신뢰도 기반 재시도/질문/교차검증
- 배치/비동기 처리: 중간 규모(예: ≤100개 파일 동시, 100k 행급 파일 처리)
- 배포: SaaS 기본 + 온프레/로컬 LLM은 옵션 (요구 시 활성화)

### 비범위(Out of scope)
- 다중 대기업 테넌트 동시 운영, 초대규모 데이터 레이크 통합
- 다국어 확장(한/영 외 언어)

## 3. 시스템 구성(상위)
- API Layer: FastAPI, `/health`, `/diagnostic-questions`, `/auto-validate`, `/batch-validate`
- Agent Layer: Tool Registry + ReACT Planner/Router + Decision/Confidence + Memory(옵션)
- Core Tools: 파서, 매칭, 집계, 검증, 리포트/Excel 출력
- Frontend: 수동 매핑 UI, 진행률/경고/신뢰도 대시보드, 한/영 전환
- Infra: 기능 플래그, 텔레메트리, 감사 로그, 보안(토큰, DLP), 워커 큐(옵션)

## 4. 운영 모드
- 기본: AI 우선 + 폴백(문자열/룰) 혼합, 신뢰도 기반 경고
- 오프라인/내부망: 폴백만 사용, 외부 전송 없음
- 배치: 스트리밍/청크 파서 + 큐 기반 병렬 처리(중간 규모)

## 5. 에이전트/질문 정책
- 핵심 24개 질문 하드코딩 유지(버전 2와 동일 세트, 기준선 일관성)
- 나머지는 에이전트가 파일 특성/프로필 기반으로 자동 생성·조정 가능
- 의심값/오류 추정 시 사용자에게 추가 질문(clarification) 후 진행
- 위험/모호 구간은 질문, 안전/명확 구간은 자동 실행
- 수동 매핑 및 재실행 경로를 항상 노출하여 복구 용이성 확보
- v3 이후 목표: 반복 업무를 넘어 비정형·신규 업무까지 10배 폭으로 확장 처리하는 에이전트(교차 파일 비교, 정책/감사 질의, 데이터 품질 진단 등)

## 6. 다국어
- 지원 언어: 한국어/영어 (2개)  
- 추가 언어: 범위 밖

## 7. 성능 목표(예시)
- 헤더 매칭 정확도: 폴백 ~70%, AI 모드 95%+ (v2 수준 유지/개선)
- 처리 용량: 단일 파일 100k 행급 처리, 동시 ≤100 파일 배치 처리
- 응답성: 대화형 UI에서 주요 액션 3초 내 피드백(진행률 포함)

## 8. 보안/프라이버시
- 기본: 최소 수집, 로그 마스킹, HTTPS/TLS
- 옵션: 온프레/로컬 LLM(요구 시), DLP 사전 점검, 감사 로그
- 감사 로그 스키마(제안): timestamp, user/role, action, resource, result/error, trace_id; 기본 보관 90일(조정 가능)

## 9. 오픈 항목(정리)
- 온프레/로컬 LLM: 기본 비활성, 요청 시 활성화 옵션으로 유지
- 배치 큐/SLA: 내부 인프라 기준 단일 큐(예: Redis/워크 큐), 처리량·시간 목표만 명시
- 다국어: 한/영 확정, 추가 언어는 추후 논의

## 10. 릴리스 메모
- v3는 "AI 에이전트 활용/UX 안정"에 집중
- 보안 강화/완전 오프라인 전천후 모드는 차기 v4 목표

## 11. v2 대비 AI/에이전트 진화
- 질문 정책: v2와 동일한 24개 고정 질문을 유지하고, v3는 에이전트가 의심 구간에만 추가 질문(clarification)·동적 질문을 보강
- 에이전트 기본값: v2는 ReACT/agent 모듈이 실험/부분 통합 상태, v3는 Tool Registry + Planner/Router + Decision/Confidence를 기본 경로로 포함
- 회복력/폴백: v2는 AI/룰 하이브리드 매칭 중심, v3는 신뢰도 기반 재시도·질문·룰 폴백을 결합해 자동 복구 경로 강화
- 배치/비동기: v2는 단일 요청 중심, v3는 스트리밍 파서 + 큐 기반 배치(중간 규모) + 진행률/경고 노출을 전제로 설계
- 메모리/케이스 학습: v2는 세션별 일회성 처리, v3는 메모리(옵션)·케이스 유사도·재실행 경로로 반복 업무 최적화
